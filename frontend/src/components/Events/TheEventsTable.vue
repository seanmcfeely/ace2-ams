/* eslint-disable vue/attribute-hyphenation */
<!-- TheEventsTable.vue -->
<!-- The table where all currently filtered events are displayed, selected to take action, or link to an individual event page -->

<template>
  <TheNodeTable :columns="columns">
    <template #rowCell="{ data, field }">
      <EventTableCell :data="data" :field="field"></EventTableCell>
    </template>

    <!-- Row Expansion -->
    <template #rowExpansion="{ data }">
      <suspense>
        <template #fallback>
          <ul></ul>
        </template>
        <template #default>
          <EventTableExpansion
            :uuid="data.uuid"
            :data="data"
          ></EventTableExpansion>
        </template>
      </suspense>
    </template>
  </TheNodeTable>
</template>

<script setup>
  import { ref } from "vue";

  import TheNodeTable from "@/components/Node/TheNodeTable.vue";
  import EventTableCell from "@/components/Events/EventTableCell.vue";
  import EventTableExpansion from "@/components/Events/EventTableExpansion.vue";

  const columns = ref([
    { field: "createdTime", header: "Created", sortable: true, default: true },
    { field: "name", header: "Name", sortable: true, default: true },
    { field: "owner", header: "Owner", sortable: true, default: true },
    { field: "status", header: "Status", sortable: true, default: false },
    { field: "type", header: "Type", sortable: true, default: true },
    { field: "vectors", header: "Vectors", sortable: false, default: true },
    {
      field: "threatActors",
      header: "Threat Actors",
      sortable: false,
      default: false,
    },
    { field: "threats", header: "Threats", sortable: false, default: false },
    {
      field: "preventionTools",
      header: "Prevention Tools",
      sortable: false,
      default: false,
    },
    {
      field: "riskLevel",
      header: "Risk Level",
      sortable: true,
      default: false,
    },
  ]);
</script>
