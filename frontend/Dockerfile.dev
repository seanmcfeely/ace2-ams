FROM cypress/included:10.0.2

RUN apt-get install -y curl

WORKDIR /app

COPY package*.json ./

RUN npm install

COPY . .

# Fixes the strange permission issues GitHub Actions was having.
RUN chmod -R 777 /app

# Override the entrypoint of the cypress/included image
ENTRYPOINT ["bash", "-c", "while !</dev/tcp/gui-api/80; do sleep 1; done; npm run dev"]
